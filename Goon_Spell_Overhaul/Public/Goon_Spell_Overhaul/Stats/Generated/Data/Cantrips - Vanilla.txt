

// ==================================== Shillelagh ====================================
// Changes: Is now a target spell instead of a shout, allowing you to target allies and weapons that aren't equipped.
// Changes: Scales from 1d8 to 1d10 at level 5, 1d12 at level 11, and 2d6 at level 17.
// Changes: Works with staff, club, mace, javelin, dart, spear, or trident.
// Changes: Lasts until long rest instead of 10 turns, the caster can only have one Shillelagh active at a time.
// Changes: The wielder can cancel the effect at will (AI will not cancel the effect).

new entry "Shout_Shillelagh"
type "SpellData"
// data "SpellType" "Shout"
data "SpellType" "Target"
// data "Level" "0"
data "Level" "0"
// data "SpellSchool" "Transmutation"
data "SpellSchool" "Transmutation"
// data "SpellProperties" "IF(IsWeaponOfProficiencyGroup('Clubs|Quarterstaffs', GetActiveWeapon())):ApplyEquipmentStatus(MainHand, SHILLELAGH, 100, 10);IF(not IsWeaponOfProficiencyGroup('Clubs|Quarterstaffs', GetActiveWeapon()) and IsWeaponOfProficiencyGroup('Clubs|Quarterstaffs', GetActiveWeapon(context.Target, false))):ApplyEquipmentStatus(OffHand, SHILLELAGH, 100, 10);AI_ONLY:IF(not HasStatus('SHILLELAGH',GetActiveWeapon())):ApplyStatus(AI_HELPER_SHILLELAGH,100,-1)"
data "SpellProperties" "ApplyStatus(SELF,GOON_SHILLELAGH_OWNER,100,-1);IF(Item() and IsWeaponOfProficiencyGroup('Clubs|Greatclubs|Quarterstaffs|Maces|Javelins|Darts|Spears|Tridents')):ApplyStatus(SHILLELAGH,100,-1);IF(Self() and not Item() and IsWeaponOfProficiencyGroup('Clubs|Greatclubs|Quarterstaffs|Maces|Javelins|Darts|Spears|Tridents', GetActiveWeapon(context.Target, true))):ApplyEquipmentStatus(MainHand,SHILLELAGH,100,-1);IF(Self() and not Item() and not IsWeaponOfProficiencyGroup('Clubs|Greatclubs|Quarterstaffs|Maces|Javelins|Darts|Spears|Tridents', GetActiveWeapon(context.Target, true)) and IsWeaponOfProficiencyGroup('Clubs|Greatclubs|Quarterstaffs|Maces|Javelins|Darts|Spears|Tridents', GetActiveWeapon(context.Target, false))):ApplyEquipmentStatus(OffHand,SHILLELAGH,100,-1);IF(not Self() and not Item() and IsWeaponOfProficiencyGroup('Clubs|Greatclubs|Quarterstaffs|Maces|Javelins|Darts|Spears|Tridents', GetActiveWeapon(context.Target, true))):ApplyEquipmentStatus(MainHand,SHILLELAGH,100,-1);IF(not Self() and not Item() and not IsWeaponOfProficiencyGroup('Clubs|Greatclubs|Quarterstaffs|Maces|Javelins|Darts|Spears|Tridents', GetActiveWeapon(context.Target, true)) and IsWeaponOfProficiencyGroup('Clubs|Greatclubs|Quarterstaffs|Maces|Javelins|Darts|Spears|Tridents', GetActiveWeapon(context.Target, false))):ApplyEquipmentStatus(OffHand,SHILLELAGH,100,-1);AI_ONLY:IF(not HasStatus('SHILLELAGH',GetActiveWeapon(context.Target, true)) and not HasStatus('SHILLELAGH',GetActiveWeapon(context.Target, false))):ApplyStatus(AI_HELPER_SHILLELAGH,100,-1)"
// data "TargetConditions" "Self()"
data "TargetConditions" "Character() or Item()"
// data "Icon" "Spell_Abjuration_Transmutation_Shillelagh"
data "Icon" "Spell_Abjuration_Transmutation_Shillelagh"
// Shillelagh
// data "DisplayName" "h88189f48ga78cg4a13ga52fg9c789a31c49e;1"
data "DisplayName" "h88189f48ga78cg4a13ga52fg9c789a31c49e;1"
// Your staff or club becomes magical: it deals [1], and uses your &lt;LSTag Tooltip="SpellcastingAbilityModifier"&gt;Spellcasting Ability&lt;/LSTag&gt; for &lt;LSTag Tooltip="AttackRoll"&gt;Attack Rolls&lt;/LSTag&gt;.
// data "Description" "hebb3bf5dg7eeeg44b7g9c75gd7ac6b4e3ce3;6"
// Target a creature's equipped weapon, or a staff, club, mace, javelin, dart, spear, or trident directly; it becomes magical and deals[5]. The weapon uses the wielder's &lt;LSTag Tooltip="SpellcastingAbilityModifier"&gt;Spellcasting Ability&lt;/LSTag&gt; for &lt;LSTag Tooltip="AttackRoll"&gt;Attack&lt;/LSTag&gt; and damage rolls.&lt;br&gt;&lt;br&gt;Damage begins at [1], increasing to [2] at level 5, [3] at level 11, and [4] at level 17.
data "Description" "h9e33ef27g4b4eg46c6gb365g6694c23fb2f0;1"
// data "DescriptionParams" "DealDamage(1d8+SpellCastingAbilityModifier, Bludgeoning)"
data "DescriptionParams" "DealDamage(1d8+SpellCastingAbilityModifier,Bludgeoning);DealDamage(1d10+SpellCastingAbilityModifier,Bludgeoning);DealDamage(1d12+SpellCastingAbilityModifier,Bludgeoning);DealDamage(2d6+SpellCastingAbilityModifier,Bludgeoning);DealDamage(,Bludgeoning)"
data "TooltipDamageList" "DealDamage(LevelMapValue(GoonShillelagh)+SpellCastingAbilityModifier, Bludgeoning)"
// data "TooltipStatusApply" "ApplyStatus(SHILLELAGH, 100, 10)"
data "TooltipStatusApply" "ApplyStatus(SHILLELAGH, 100, -1)"
// data "CastSound" "Spell_Cast_Buff_Shillelagh_L0"
data "CastSound" "Spell_Cast_Buff_Shillelagh_L0"
// data "TargetSound" "Spell_Impact_Buff_Shillelagh_L0"
data "TargetSound" "Spell_Impact_Buff_Shillelagh_L0"
// data "VocalComponentSound" "Vocal_Component_EnchantWeapon"
data "VocalComponentSound" "Vocal_Component_EnchantWeapon"
data "PreviewCursor" "Cast"
// data "CastTextEvent" "Cast"
data "CastTextEvent" "Cast"
data "AlternativeCastTextEvents" "CastOffhand"
// data "UseCosts" "BonusActionPoint:1"
data "UseCosts" "BonusActionPoint:1"
// data "SpellAnimation" "8b8bb757-21ce-4e02-a2f3-97d55cf2f90b,,;,,;35b644cf-5c13-4407-9dc1-23bf4309216e,,;823e3ddf-c670-41ef-b7b4-9f4a4e38300b,,;7bb52cd4-0b1c-4926-9165-fa92b75876a3,,;,,;0b07883a-08b8-43b6-ac18-84dc9e84ff50,,;,,;,,"
data "SpellAnimation" "03496c4a-49e0-4132-b585-3e5ecd1ad8e5,,;,,;dada6495-752c-4f30-a503-f05b8c811e2b,,;8ce53f9b-b559-49cd-9607-1991545060d7,,;a9682ef9-5d9e-4ac0-8144-2c7fe6eb868c,,;,,;32fb4d91-7fde-4b05-9144-ea87b9a4284a,,;,,;,,"
// data "VerbalIntent" "Buff"
data "VerbalIntent" "Buff"
// data "WeaponTypes" "Melee"
data "WeaponTypes" "Melee"
// data "SpellFlags" "HasVerbalComponent;IsMelee;IsSpell;HasSomaticComponent"
data "SpellFlags" "HasVerbalComponent;IsMelee;IsSpell;HasSomaticComponent"
// data "SpellAnimationIntentType" "Aggressive"
data "SpellAnimationIntentType" "Aggressive"
// data "RequirementConditions" "IsWeaponOfProficiencyGroup('Clubs|Quarterstaffs', GetItemInEquipmentSlot(EquipmentSlot.MeleeMainHand)) or IsWeaponOfProficiencyGroup('Clubs|Quarterstaffs', GetItemInEquipmentSlot(EquipmentSlot.MeleeOffHand))"
// data "RequirementEvents" "OnEquip;OnUnequip"
data "RequirementEvents" "OnEquip;OnUnequip"
// data "PrepareEffect" "e8109f4b-2439-4424-9bc8-743270220f47"
data "PrepareEffect" "e8109f4b-2439-4424-9bc8-743270220f47"
// data "CastEffect" "53c9d361-0fc1-4d72-a70b-bc2611d538f0"
data "CastEffect" "53c9d361-0fc1-4d72-a70b-bc2611d538f0"
// data "Sheathing" "Melee"
data "Sheathing" "Melee"
data "MaximumTargets" "1"
data "HitAnimationType" "None"

// TODO: Clean below Shillelagh entries.
new entry "SHILLELAGH"
type "StatusData"
data "StatusType" "BOOST"
using "SHILLELAGH"
// Weapon is magical and deals [5]. &lt;LSTag Tooltip="AttackRoll"&gt;Attack Rolls&lt;/LSTag&gt; use the wielder's &lt;LSTag Tooltip="SpellcastingAbilityModifier"&gt;Spellcasting Ability Modifier&lt;/LSTag&gt;.&lt;br&gt;&lt;br&gt;Damage begins at [1], increasing to [2] at level 5, [3] at level 11, and [4] at level 17.
data "Description" "hab375000gaeb1g47dfg9d34ga2a778b28194;1"
// data "DescriptionParams" "DealDamage(1d8+SpellCastingAbility, Bludgeoning)"
data "DescriptionParams" "DealDamage(1d8+SpellCastingAbilityModifier,Bludgeoning);DealDamage(1d10+SpellCastingAbilityModifier,Bludgeoning);DealDamage(1d12+SpellCastingAbilityModifier,Bludgeoning);DealDamage(2d6+SpellCastingAbilityModifier,Bludgeoning);DealDamage(,Bludgeoning)"
// data "Boosts" "WeaponProperty(Magical);WeaponDamageDieOverride(1d8);WeaponAttackRollAbilityOverride(SpellCastingAbility);Attribute(InventoryBound)"
data "Boosts" "WeaponProperty(Magical);WeaponDamageTypeOverride(Bludgeoning);WeaponAttackRollAbilityOverride(SpellCastingAbility);IF(not CharacterLevelGreaterThan(4,GetOwner(context.Source))):WeaponDamageDieOverride(1d8);IF(CharacterLevelGreaterThan(4,GetOwner(context.Source)) and not CharacterLevelGreaterThan(9,GetOwner(context.Source))):WeaponDamageDieOverride(1d10);IF(CharacterLevelGreaterThan(10,GetOwner(context.Source)) and not CharacterLevelGreaterThan(17,GetOwner(context.Source))):WeaponDamageDieOverride(1d12);IF(CharacterLevelGreaterThan(17,GetOwner(context.Source))):WeaponDamageDieOverride(2d6)"
// data "RemoveConditions" ""
data "RemoveConditions" "HasStatus('GOON_SHILLELAGH_REMOVAL_TECHNICAL') or not HasStatus('GOON_SHILLELAGH_OWNER', GetSummoner(context.Source))"
// data "RemoveEvents" ""
data "RemoveEvents" "OnStatusApplied"
// data "Passives" ""
// data "Passives" "Goon_Remove_Shillelagh_Passive"
// data "IsUnique" ""
data "IsUnique" "1"

// Owner status
new entry "GOON_SHILLELAGH_OWNER"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog;IgnoreResting;ApplyToDead"
data "StatusGroups" "SG_RemoveOnRespec"

// Custom entries for handling removal
new entry "Goon_Remove_Shillelagh_Passive"
type "PassiveData"
data "Properties" "IsHidden"
data "BoostContext" "OnStatusApplied;OnStatusApply;OnStatusRemoved;OnStatusRemove;OnEquip;OnCreate;OnInventoryChanged;OnCast;OnHealed;OnDamaged"
data "Boosts" "IF(HasStatus('SHILLELAGH',GetItemInEquipmentSlot(EquipmentSlot.MeleeMainHand)) or HasStatus('SHILLELAGH',GetItemInEquipmentSlot(EquipmentSlot.MeleeOffHand)) or HasStatus('SHILLELAGH_DRYAD',GetItemInEquipmentSlot(EquipmentSlot.MeleeMainHand)) or HasStatus('SHILLELAGH_DRYAD',GetItemInEquipmentSlot(EquipmentSlot.MeleeOffHand))):UnlockSpell(Goon_Shout_Remove_Shillelagh)"

new entry "Goon_Shout_Remove_Shillelagh"
type "SpellData"
data "SpellType" "Shout"
data "SpellProperties" "AI_IGNORE:ApplyEquipmentStatus(MainHand,GOON_SHILLELAGH_REMOVAL_TECHNICAL,100,0);AI_IGNORE:ApplyEquipmentStatus(OffHand,GOON_SHILLELAGH_REMOVAL_TECHNICAL,100,0)"
data "Icon" "Spell_Abjuration_Transmutation_Shillelagh"
data "DisplayName" "h871c4f36g3d7fg4798ga7ecg05fd146c364c;1"
data "Description" "h1ee9b7a0ge6a5g407bgb29cgbe27ad5d4221;1"
data "CastSound" "Spell_Cast_Buff_Shillelagh_L0"
data "TargetSound" "Spell_Impact_Buff_Shillelagh_L0"
data "SpellAnimation" "8b8bb757-21ce-4e02-a2f3-97d55cf2f90b,,;,,;35b644cf-5c13-4407-9dc1-23bf4309216e,,;823e3ddf-c670-41ef-b7b4-9f4a4e38300b,,;7bb52cd4-0b1c-4926-9165-fa92b75876a3,,;,,;0b07883a-08b8-43b6-ac18-84dc9e84ff50,,;,,;,,"
data "SpellFlags" "Temporary"
data "PrepareEffect" "e8109f4b-2439-4424-9bc8-743270220f47"
data "CastEffect" "53c9d361-0fc1-4d72-a70b-bc2611d538f0"
data "RequirementConditions" "Player(context.Source)"

new entry "GOON_SHILLELAGH_REMOVAL_TECHNICAL"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"

new entry "GOON_SHILLELAGH_DUMMY_UNLOCK_REMOVAL"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"

new entry "GOON_SHILLELAGH_DUMMY_UNLOCK_REMOVAL_2"
type "StatusData"
data "StatusType" "BOOST"
data "StatusPropertyFlags" "DisableOverhead;DisablePortraitIndicator;DisableCombatlog"

// Shit inheriting from Shillelagh
new entry "Shout_Shillelagh_Dryad"
type "SpellData"
// data "SpellType" "Shout"
data "SpellType" "Target"
using "Shout_Shillelagh"
data "Level" ""
data "SpellSchool" ""
// data "SpellProperties" "IF(IsWeaponOfProficiencyGroup('Clubs|Quarterstaffs', GetActiveWeapon())):ApplyEquipmentStatus(MainHand, SHILLELAGH_DRYAD, 100, 10);IF(not IsWeaponOfProficiencyGroup('Clubs|Quarterstaffs', GetActiveWeapon()) and IsWeaponOfProficiencyGroup('Clubs|Quarterstaffs', GetActiveWeapon(context.Target, false))):ApplyEquipmentStatus(OffHand, SHILLELAGH_DRYAD, 100, 10);AI_ONLY:IF(not HasStatus('SHILLELAGH_DRYAD',GetActiveWeapon())):ApplyStatus(AI_HELPER_SHILLELAGH,100,-1)"
data "SpellProperties" "ApplyStatus(SELF,GOON_SHILLELAGH_OWNER,100,-1);IF(Item() and IsWeaponOfProficiencyGroup('Clubs|Greatclubs|Quarterstaffs|Maces|Javelins|Darts|Spears|Tridents')):ApplyStatus(SHILLELAGH_DRYAD,100,-1);IF(not Item() and IsWeaponOfProficiencyGroup('Clubs|Greatclubs|Quarterstaffs|Maces|Javelins|Darts|Spears|Tridents', GetActiveWeapon())):ApplyEquipmentStatus(MainHand,SHILLELAGH_DRYAD,100,-1);IF(not IsWeaponOfProficiencyGroup('Clubs|Greatclubs|Quarterstaffs|Maces|Javelins|Darts|Spears|Tridents', GetActiveWeapon()) and IsWeaponOfProficiencyGroup('Clubs|Greatclubs|Quarterstaffs|Maces|Javelins|Darts|Spears|Tridents', GetActiveWeapon(context.Target, false))):ApplyEquipmentStatus(OffHand,SHILLELAGH_DRYAD,100,-1);AI_ONLY:IF(not HasStatus('SHILLELAGH_DRYAD',GetActiveWeapon())):ApplyStatus(AI_HELPER_SHILLELAGH,100,-1)"
data "Icon" "Action_Monster_Dryad_Shillelagh"
// Strengthened Shillelagh
data "DisplayName" "h09951a86gfbe8g44c8g90ecg818674bc3995;1"
// Your staff or club becomes magical: it deals [1], and uses your &lt;LSTag Tooltip="SpellcastingAbilityModifier"&gt;Spellcasting Ability&lt;/LSTag&gt; for &lt;LSTag Tooltip="AttackRoll"&gt;Attack Rolls&lt;/LSTag&gt;.
data "Description" "hebb3bf5dg7eeeg44b7g9c75gd7ac6b4e3ce3;6"
data "DescriptionParams" "DealDamage(4d8+SpellCastingAbilityModifier, Bludgeoning)"
// data "TooltipStatusApply" "ApplyStatus(SHILLELAGH_DRYAD, 100, 10)"
data "TooltipStatusApply" "ApplyStatus(SHILLELAGH_DRYAD, 100, -1)"
data "CastSound" "CrSpell_Cast_Dryad_Shillelagh"
data "PrepareEffect" "3400259d-131e-42ed-a447-4578933d76de"
data "CastEffect" "b34ed591-57e1-44f0-8a25-a0a4a040bbf9"
data "CombatAIOverrideSpell" "Shout_Shillelagh_Dryad_AI"

new entry "Shout_Shillelagh_Dryad_AI"
type "SpellData"
data "SpellType" "Projectile"
using "Shout_Shillelagh_Dryad"
// data "TargetConditions" "Character() or Item()"
data "TargetConditions" "Self()"
data "CombatAIOverrideSpell" ""

new entry "SHILLELAGH_DRYAD"
type "StatusData"
data "StatusType" "BOOST"
// using "SHILLELAGH"
using "SHILLELAGH_DRYAD"
// data "Boosts" "WeaponProperty(Magical);WeaponDamageDieOverride(4d8);WeaponAttackRollAbilityOverride(SpellCastingAbility);Attribute(InventoryBound)"
data "Boosts" "WeaponProperty(Magical);WeaponDamageDieOverride(4d8);WeaponAttackRollAbilityOverride(SpellCastingAbility)"

// Why does this shit even inherit my god
new entry "Shout_MAG_Harpers_SingingSword_Container"
type "SpellData"
data "SpellType" "Shout"
// using "Shout_Shillelagh"
using "Shout_MAG_Harpers_SingingSword_Container"
data "SpellProperties" ""
data "TargetConditions" "Self()"
data "TooltipDamageList" ""
data "CastSound" "Spell_Cast_Buff_Shillelagh_L0"
data "TargetSound" "Spell_Impact_Buff_Shillelagh_L0"
data "VocalComponentSound" "Vocal_Component_EnchantWeapon"
data "CastTextEvent" "Cast"
data "SpellAnimation" "8b8bb757-21ce-4e02-a2f3-97d55cf2f90b,,;,,;35b644cf-5c13-4407-9dc1-23bf4309216e,,;823e3ddf-c670-41ef-b7b4-9f4a4e38300b,,;7bb52cd4-0b1c-4926-9165-fa92b75876a3,,;,,;0b07883a-08b8-43b6-ac18-84dc9e84ff50,,;,,;,,"
data "VerbalIntent" "Buff"
data "WeaponTypes" "Melee"
data "SpellAnimationIntentType" "Aggressive"
data "PrepareEffect" "e8109f4b-2439-4424-9bc8-743270220f47"
data "CastEffect" "53c9d361-0fc1-4d72-a70b-bc2611d538f0"
data "Sheathing" "Melee"
data "MaximumTargets" ""

new entry "Shout_MAG_Harpers_SingingSword_Shriek"
type "SpellData"
data "SpellType" "Shout"
// using "Shout_Shillelagh"
using "Shout_MAG_Harpers_SingingSword_Shriek"
data "TargetConditions" "Self()"
data "TooltipDamageList" ""
data "SpellAnimation" "8b8bb757-21ce-4e02-a2f3-97d55cf2f90b,,;,,;35b644cf-5c13-4407-9dc1-23bf4309216e,,;823e3ddf-c670-41ef-b7b4-9f4a4e38300b,,;7bb52cd4-0b1c-4926-9165-fa92b75876a3,,;,,;0b07883a-08b8-43b6-ac18-84dc9e84ff50,,;,,;,,"
data "Sheathing" "Melee"
data "MaximumTargets" ""

new entry "Shout_MAG_Harpers_SingingSword_Sing"
type "SpellData"
data "SpellType" "Shout"
// using "Shout_Shillelagh"
using "Shout_MAG_Harpers_SingingSword_Sing"
data "TargetConditions" "Self()"
data "TooltipDamageList" ""
data "SpellAnimation" "8b8bb757-21ce-4e02-a2f3-97d55cf2f90b,,;,,;35b644cf-5c13-4407-9dc1-23bf4309216e,,;823e3ddf-c670-41ef-b7b4-9f4a4e38300b,,;7bb52cd4-0b1c-4926-9165-fa92b75876a3,,;,,;0b07883a-08b8-43b6-ac18-84dc9e84ff50,,;,,;,,"
data "Sheathing" "Melee"
data "MaximumTargets" ""

// ==================================== True Strike ====================================
// Changes: Now costs a Bonus Action instead of an Action.
// Changes: Advantage is now only granted if the target fails an Intelligence Saving Throw, using the caster's Spell Save DC.
// Changes: The target always has their AC reduced by the caster's Proficiency Bonus, and half on a successful save(rounded up). But the effect and its duration is reduced by 1 each time they are attacked.
// TODO: I kinda wanna re-rework this.

new entry "Target_TrueStrike"
type "SpellData"
data "SpellType" "Target"
using "Target_TrueStrike"
// data "Level" "0"
// data "SpellSchool" "Divination"
data "SpellRoll" "not SavingThrow(Ability.Intelligence, SourceSpellDC())"
data "SpellSuccess" "ApplyStatus(TRUE_STRIKE,100,1);ApplyStatus(SELF,TRUE_STRIKE_OWNER,100,1);IF(not CharacterLevelGreaterThan(4,context.Source)):ApplyStatus(GOON_TRUE_STRIKE,100,2);IF(CharacterLevelGreaterThan(4,context.Source) and not CharacterLevelGreaterThan(8,context.Source)):ApplyStatus(GOON_TRUE_STRIKE,100,3);IF(CharacterLevelGreaterThan(8,context.Source) and not CharacterLevelGreaterThan(13,context.Source)):ApplyStatus(GOON_TRUE_STRIKE,100,4);IF(CharacterLevelGreaterThan(13,context.Source) and not CharacterLevelGreaterThan(17,context.Source)):ApplyStatus(GOON_TRUE_STRIKE,100,5);IF(CharacterLevelGreaterThan(17,context.Source)):ApplyStatus(GOON_TRUE_STRIKE,100,6)"
// data "SpellProperties" "ApplyStatus(TRUE_STRIKE,100,2);ApplyStatus(SELF,TRUE_STRIKE_OWNER,100,2)"
data "SpellProperties" ""
data "SpellFail" "IF(not CharacterLevelGreaterThan(4,context.Source)):ApplyStatus(GOON_TRUE_STRIKE,100,1);IF(CharacterLevelGreaterThan(4,context.Source) and not CharacterLevelGreaterThan(8,context.Source) and not CharacterLevelGreaterThan(13,context.Source)):ApplyStatus(GOON_TRUE_STRIKE,100,2);IF(CharacterLevelGreaterThan(8,context.Source)):ApplyStatus(GOON_TRUE_STRIKE,100,2);IF(CharacterLevelGreaterThan(13,context.Source) and not CharacterLevelGreaterThan(17,context.Source)):ApplyStatus(GOON_TRUE_STRIKE,100,3);IF(CharacterLevelGreaterThan(17,context.Source)):ApplyStatus(GOON_TRUE_STRIKE,100,3)"
// data "TargetRadius" "18"
// data "TargetConditions" "Character() and not Self()"
// data "Icon" "Spell_Divination_TrueStrike"
// True Strike
// data "DisplayName" "haa14210cgd4e8g403cgbd07g3a63fea901c9;1"
// Gain &lt;LSTag Tooltip="Advantage"&gt;Advantage&lt;/LSTag&gt; on your next &lt;LSTag Tooltip="AttackRoll"&gt;Attack Roll&lt;/LSTag&gt;.
// data "Description" "he014b03bg6138g431dga1ecg45e4ebba4869;2"
// Attempt to predict the actions of other creatures: if your target fails an &lt;LSTag Tooltip="Intelligence"&gt;Intelligence&lt;/LSTag&gt; &lt;LSTag Tooltip="SavingThrow"&gt;Saving Throw&lt;/LSTag&gt; you gain &lt;LSTag Tooltip="Advantage"&gt;Advantage&lt;/LSTag&gt; on your next &lt;LSTag Tooltip="AttackRoll"&gt;Attack Roll&lt;/LSTag&gt; against them.&lt;br&gt;&lt;br&gt;Additionally, their &lt;LSTag Tooltip="ArmourClass"&gt;Armour Class&lt;/LSTag&gt; is reduced equal to your &lt;LSTag Tooltip="ProficiencyBonus"&gt;Proficiency Bonus&lt;/LSTag&gt;, halved on a successful save (rounded down).
data "Description" "h7f444266g81afg4e0eg95d8g90b8876bf040;1"
data "DescriptionParams" ""
// data "TooltipStatusApply" "ApplyStatus(TRUE_STRIKE,100,2)"
data "TooltipStatusApply" "ApplyStatus(TRUE_STRIKE,100,1);ApplyStatus(GOON_TRUE_STRIKE,100,1)"
// data "PrepareSound" "Spell_Prepare_Debuff_Gen_L1to3_01"
// data "PrepareLoopSound" "Spell_Prepare_Debuff_Gen_L1to3_01_Loop"
// data "CastSound" "Spell_Cast_Debuff_TrueStrike_L1to3"
// data "TargetSound" "Spell_Impact_Debuff_TrueStrike_L1to3"
// data "CastTextEvent" "Cast"
// data "UseCosts" "ActionPoint:1"
data "UseCosts" "BonusActionPoint:1"
// data "SpellAnimation" "9313094a-bae2-454f-9701-f920d0e8e98d,,;,,;3e441d3f-11f9-432d-877c-c0ba4d92c74a,,;8b7ae969-2a04-4720-9685-3bde54c18ffe,,;808fdfab-2e6c-472e-b3c4-19ce4a719d9d,,;,,;ea745d30-eb87-447f-b190-c81298e27d9c,,;,,;,,"
// data "VerbalIntent" "Debuff"
// data "SpellFlags" "HasSomaticComponent;IsSpell;HasHighGroundRangeExtension;IsConcentration;IsHarmful"
data "HitAnimationType" "None"
// data "PrepareEffect" "556fd141-698d-4c08-9322-ad155821260a"
// data "CastEffect" "0340b957-f9eb-45bc-9c6f-d4def37f5249"
// data "TargetEffect" "de333436-aa42-45cc-a3da-14277ca1df60"

// Custom
new entry "GOON_TRUE_STRIKE"
type "StatusData"
data "StatusType" "BOOST"
// Open Defenses
data "DisplayName" "h6cc73e50gf680g4b25ga7d5g12f31475c508;1"
// &lt;LSTag Tooltip="ArmourClass"&gt;Armour Class&lt;/LSTag&gt; is reduced equal to the duration of Open Defenses.&lt;br&gt;&lt;br&gt;Whenever the creature is attacked the duration is reduced by 1.
data "Description" "h9a4f4618g7ae6g4741g9519gb03d2851d055;1"
data "Icon" "GenericIcon_Intent_Debuff"
data "StackId" "GOON_TRUE_STRIKE"
data "StackType" "Additive"
data "Boosts" "AC(-1)"
data "StatusPropertyFlags" "MultiplyEffectsByDuration"
data "Passives" "Goon_True_Strike"

new entry "Goon_True_Strike"
type "PassiveData"
data "Properties" "IsHidden"
data "StatsFunctorContext" "OnAttacked"
data "Conditions" ""
data "StatsFunctors" "SetStatusDuration(GOON_TRUE_STRIKE,-1,Add)"

// ==================================== Vicious Mockery ====================================
// Bug Fix: The hidden status "SAVED_AGAINST_HOSTILE_SPELL" will now apply. 
// Changes: Damage increased from 1d4 to 1d8.
// Changes: Can now target objects and allies, AI will only target hostile characters.

new entry "Target_ViciousMockery"
type "SpellData"
data "SpellType" "Target"
using "Target_ViciousMockery"
// data "Level" "0"
// data "SpellSchool" "Enchantment"
// data "TargetRadius" "18"
// data "SpellRoll" "not SavingThrow(Ability.Wisdom, SourceSpellDC())"
// data "SpellSuccess" "ApplyStatus(VICIOUSMOCKERY,100,1);DealDamage(LevelMapValue(D4Cantrip),Psychic,Magical)"
data "SpellSuccess" "IF(Character(context.Target)):ApplyStatus(VICIOUSMOCKERY,100,1);IF(Character(context.Target)):DealDamage(LevelMapValue(D8Cantrip),Psychic,Magical)"
data "SpellProperties" "IF(Item(context.Target)):ApplyStatus(GOON_VICIOUSMOCKERY_NOTOFFENDED,100,1);IF(Dead(context.Target)):ApplyStatus(GOON_VICIOUSMOCKERY_NOTOFFENDED_DEAD,100,1)"
// data "SpellFail" "IF(HasPassive('PotentCantrip',context.Source)):DealDamage((LevelMapValue(D4Cantrip))/2,Psychic,Magical), IF(not HasPassive('PotentCantrip',context.Source)):ApplyStatus(SAVED_AGAINST_HOSTILE_SPELL,100,0)"
data "SpellFail" "IF(HasPassive('PotentCantrip',context.Source) and Character(context.Target)):DealDamage((LevelMapValue(D8Cantrip))/2,Psychic,Magical);IF(not HasPassive('PotentCantrip',context.Source)):ApplyStatus(SAVED_AGAINST_HOSTILE_SPELL,100,0)"
// data "TargetConditions" "Character() and not Ally()"
data "TargetConditions" "not Self() and (Item() or Character() or Dead())"
// data "Icon" "Spell_Enchantment_ViciousMockery"
// Vicious Mockery
// data "DisplayName" "h0455dad7gaff9g4f23g9f7eg85a1c4ce240c;1"
// Insult a creature: it has &lt;LSTag Tooltip="Disadvantage"&gt;Disadvantage&lt;/LSTag&gt; on its next &lt;LSTag Tooltip="AttackRoll"&gt;Attack Roll&lt;/LSTag&gt;.
// data "Description" "h24e24d25ga325g49d9g9f08g44507f959598;6"
// data "TooltipDamageList" "DealDamage(LevelMapValue(D4Cantrip),Psychic)"
data "TooltipDamageList" "DealDamage(LevelMapValue(D8Cantrip),Psychic)"
// data "TooltipAttackSave" "Wisdom"
// data "TooltipStatusApply" "ApplyStatus(VICIOUSMOCKERY,100,1)"
// data "PrepareSound" "Vocal_Component_PrepareViciousMockery"
// data "CastSound" "Spell_Cast_Damage_Psychic_ViciousMockery_L1to3"
// data "TargetSound" "Spell_Impact_Damage_Psychic_ViciousMockery_L1to3"
// data "VocalComponentSound" "Vocal_Component_ViciousMockery"
// data "CastTextEvent" "Cast"
// data "CycleConditions" "Enemy() and not Dead()"
// data "UseCosts" "ActionPoint:1"
// data "SpellAnimation" "ff78157b-f004-4813-b6d7-83744a7a56e4,,;,,;ebc9253d-d2b2-4657-b8c1-df334c6047b1,,;3aa138db-f6d7-495b-a34f-281b1d71fbc9,,;34da5af5-71b6-4278-9cc0-d5266ca98876,,;,,;32eb3c27-cd2c-49c1-a6c6-b21b2cccf050,,;,,;,,"
// data "VerbalIntent" "Damage"
// data "SpellFlags" "IsSpell;HasVerbalComponent;IsHarmful"
// data "HitAnimationType" "MagicalDamage_Psychic"
// data "PrepareEffect" "15f05cf9-02e4-45df-83ce-fd82b04a7fa1"
// data "CastEffect" "77e698a6-412f-43db-be9e-68e9a6f3afa7"
// data "TargetEffect" "4fb18d5c-33c6-4ee9-b8ea-22f0923a32f7"
// data "BeamEffect" "2c70ac69-71bf-4fef-b82d-caea934e102e"
// data "DamageType" "Psychic"
// data "Sheathing" "Sheathed"
data "CombatAIOverrideSpell" "Target_ViciousMockery_AI"

new entry "Target_ViciousMockery_AI"
type "SpellData"
data "SpellType" "Projectile"
using "Target_ViciousMockery"
// data "TargetConditions" "not Self() and (Item() or Character() or Dead())"
data "TargetConditions" "Character() and not Ally()"
data "CombatAIOverrideSpell" ""

new entry "GOON_VICIOUSMOCKERY_NOTOFFENDED"
type "StatusData"
data "StatusType" "BOOST"
// No Offense Taken
data "DisplayName" "he4b11470g6ad9g48e4g9788gdaa572a35a9d;1"
// You question the impact your words have had upon the object.
data "Description" "h39505cfcga0d3g430bg93degbed42f5ff652;1"
data "Icon" "Spell_Enchantment_ViciousMockery"
data "StackId" "GOON_VICIOUSMOCKERY_NOTOFFENDED"
data "StatusPropertyFlags" "DisableCombatlog;DisablePortraitIndicator;ForceOverhead"

new entry "GOON_VICIOUSMOCKERY_NOTOFFENDED_DEAD"
type "StatusData"
data "StatusType" "BOOST"
using "GOON_VICIOUSMOCKERY_NOTOFFENDED"
// You question the impact your words have had upon the corpse.
data "Description" "h9d0ca952g02fag464bgac97g14194b425390;1"